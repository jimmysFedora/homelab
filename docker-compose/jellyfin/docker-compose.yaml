services:
  jellyfin:
    image: linuxserver/jellyfin:10.11.6@sha256:df1ccfdd214c39c9ae0595b5800591b52a6f87bbbab1bd4a53dc7be6852cf6b1
    container_name: jellyfin
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=America/Denver
    volumes:
      - /mnt/docker-nfs/volumes/jellyfin-data:/config
      - /mnt/octapool-nfs/blu-ray:/data/blu-ray
      - /mnt/octapool-nfs/dvds:/data/dvds
      - /mnt/octapool-nfs/tv:/data/tv
    # ports:
    #   - 8096:8096
    restart: unless-stopped
    # deploy:
    #   resources:
    #     reservations:
    #       devices:
    #         - driver: nvidia
    #           count: all
    #           capabilities: [all]
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.jellyfin-insecure.rule=Host(`jellyfin.mistyfumes.dev`)"
      - "traefik.http.routers.jellyfin-insecure.entrypoints=http"
      - "traefik.http.routers.jellyfin-insecure.middlewares=https-redirect@file"
      - "traefik.http.routers.jellyfin-secure.rule=Host(`jellyfin.mistyfumes.dev`)"
      - "traefik.http.routers.jellyfin-secure.entrypoints=https"
      - "traefik.http.routers.jellyfin-secure.tls=true"
      - "traefik.http.routers.jellyfin-secure.tls.certresolver=cloudflare"
      - "traefik.http.services.jellyfin.loadbalancer.server.port=8096"
    networks:
      - frontend

networks:
  frontend:
    external: true